{
  "hash": "ff0cf1c8077f3c0c0a42edc44c15241d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"in class exercise 10\"\nformat: html\neditor: visual\nexecute: \n  freeze: true\n  eval: false\n---\n\n\n\n\n\n# Getting Started\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(olsrr, ggstatsplot, sf,tmap, tidyverse, gtsummary, performance, see, sfdep)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_resale <- read_csv(\"data/Condo_resale_2015.csv\")\n\nmpsz <- read_rds(\"data/rds/mpsz.rds\")\n\ncondo_resale_sf <- read_rds(\"data/rds/condo_resale_sf.rds\")\n```\n:::\n\n\n\n\n\n# Correlation Analysis\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggcorrmat(condo_resale[, 5:23])\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_mlr <- lm(formula = SELLING_PRICE ~ AREA_SQM + \n                  AGE   + PROX_CBD + PROX_CHILDCARE + \n                  PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n                  PROX_HAWKER_MARKET    + PROX_KINDERGARTEN + \n                  PROX_MRT  + PROX_PARK + PROX_PRIMARY_SCH + \n                  PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + \n                  PROX_SUPERMARKET + PROX_BUS_STOP + \n                  NO_Of_UNITS + FAMILY_FRIENDLY + \n                  FREEHOLD + LEASEHOLD_99YR, \n                data=condo_resale_sf)\n\nsummary(condo_mlr)\n```\n:::\n\n\n\n\n\ngenerating tidy linear regression report\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nols_regress(condo_mlr)\n```\n:::\n\n\n\n\n\nVariable selection\n\nstepwise regression\n\nforward stepwise\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_fw_mlr <- ols_step_forward_p(\n  condo_mlr,\n  p_val = 0.05,\n  details = FALSE)\ncondo_fw_mlr\n```\n:::\n\n\n\n\n\nbackward step\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_bw_mlr <- ols_step_backward_p(\n  condo_mlr,\n  p_val = 0.05,\n  details = FALSE)\ncondo_bw_mlr\n```\n:::\n\n\n\n\n\nstepwise\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_sb_mlr <- ols_step_both_p(\n  condo_mlr,\n  p_val = 0.05,\n  details = FALSE)\ncondo_sb_mlr\n```\n:::\n\n\n\n\n\n# Model Selection\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmetric <- compare_performance(condo_mlr, \n                    condo_fw_mlr$model,\n                    condo_bw_mlr$model,\n                    condo_sb_mlr$model)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmetric$Name <- gsub(\".*\\\\\\\\([a-zA-Z0-9_]+)\\\\\\\\, \\\\\\\\model\\\\\\\\.*\", \"\\\\1\", metric$Name)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(metric)\n```\n:::\n\n\n\n\n\n# Visualizing Model Parameters\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggcoefstats(condo_sb_mlr$model,\n            sort = \"ascending\")\n```\n:::\n\n\n\n\n\nVIF measures how much variance of estimated regr coeffs is inflated compared to when pred vars are not linearly related\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_collinearity(condo_sb_mlr$model)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(check_collinearity(condo_sb_mlr$model)) +\n  theme(axis.text.x = element_text(\n    angle = 45, hjust = 1))\n```\n:::\n\n\n\n\n\n## Linearity assumption test\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nout <- plot(check_model(condo_sb_mlr$model, \n                        panel = FALSE))\nout[[2]]\n```\n:::\n\n\n\n\n\nthe r/s btwn the dep var and indep. vars are linear\n\n## Normality assumption test\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(check_normality(condo_sb_mlr$model))\n```\n:::\n\n\n\n\n\nresidual resembles normal distribution\n\n## Checking outliers\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\noutliers <- check_outliers(condo_sb_mlr$model,\n                           method = \"cook\")\noutliers\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(check_outliers(condo_sb_mlr$model,\n                           method = \"cook\"))\n```\n:::\n\n\n\n\n\n# Spatial Non-stationary Assumption\n\nH0: residuals are randomly distributed\n\nH1: residuals are spatially non stationary\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmlr_output <- as.data.frame(condo_fw_mlr$model$residuals) %>%\n  rename(`FW_MLR_RES` = `condo_fw_mlr$model$residuals`)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_resale_sf <- cbind(condo_resale_sf, \n                        mlr_output$FW_MLR_RES) %>%\n  rename(`MLR_RES` = `mlr_output.FW_MLR_RES`)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"view\")\ntm_shape(mpsz)+\n  tmap_options(check.and.fix = TRUE) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(condo_resale_sf) +  \n  tm_dots(col = \"MLR_RES\",\n          alpha = 0.6,\n          style=\"quantile\") \ntmap_mode(\"plot\")\n```\n:::\n\n\n\n\n\n# Spatial stationary test\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_resale_sf <- condo_resale_sf %>%\n  mutate(nb = st_knn(geometry, k=6,\n                     longlat = FALSE),\n         wt = st_weights(nb,\n                         style = \"W\"),\n         .before = 1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglobal_moran_perm(condo_resale_sf$MLR_RES, \n                  condo_resale_sf$nb, \n                  condo_resale_sf$wt, \n                  alternative = \"two.sided\", \n                  nsim = 99)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}